##how to get out of R
quit()
library(dplyr)
##pattern + group
groups <- c("nissle", "mutans")
pattern <- c("_N", "_M")
sort_cheat <- data.frame(groups, pattern)
print(sort_cheat)
##function to extract out each fastq file and grab expression(tpm)
sample_exp <- function(file, sample_name){
file <- paste0("kall_out/",sample_name,"/abundance.tsv")
df <- read.delim(file)
return(df[,c(1,5)])
}
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
print(sample_name)
##extract tpm from each file in directory
exp_table <- data.frame()
nissle_table <- data.frame()
mutans_table <- data.frame()
for (name in sample_name){
print(name)
file <- paste0("kall_out/",name,"/abundance.tsv")
#print(file)
df_tmp <- sample_exp(file, name)
colnames(df_tmp)[2] <- name;
if( dim(exp_table)[1]==0){ exp_table = df_tmp}
else { exp_table <- full_join(exp_table,df_tmp,by = "target_id")}
#print(colnames(exp_table))
nissle_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_N")))
mutans_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_M")))
}
for (i in 1:nrow(sort_cheat)){
#print(sort_cheat[i,"groups"])
name <- sort_cheat[i,"groups"]
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
paste0(groups, "_table") <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
}
file <- paste0("kall_out/",sample_name,"/abundance.tsv")
##function to extract out each fastq file and grab expression(tpm)
sample_exp <- function(file, sample_name){
file <- paste0("kall_out/",sample_name,"/abundance.tsv")
df <- read.delim(file)
return(df[,c(1,5)])
}
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
print(sample_name)
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
list.dirs()
list.dirs(path = "kall_out/")
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
print(sample_name)
pwd()
cwd()
?pwd
??pwd
getwd()
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "databank/collin/kall_out/", full.names = FALSE, recursive = FALSE))
#sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
print(sample_name)
##extract tpm from each file in directory
exp_table <- data.frame()
nissle_table <- data.frame()
mutans_table <- data.frame()
for (name in sample_name){
print(name)
file <- paste0("kall_out/",name,"/abundance.tsv")
#print(file)
df_tmp <- sample_exp(file, name)
colnames(df_tmp)[2] <- name;
if( dim(exp_table)[1]==0){ exp_table = df_tmp}
else { exp_table <- full_join(exp_table,df_tmp,by = "target_id")}
#print(colnames(exp_table))
nissle_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_N")))
mutans_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_M")))
}
setwd("databank/collin")
##collect all files in directory "kall_out"
sample_name <- c(list.dirs(path = "kall_out/", full.names = FALSE, recursive = FALSE))
print(sample_name)
##extract tpm from each file in directory
exp_table <- data.frame()
nissle_table <- data.frame()
mutans_table <- data.frame()
for (name in sample_name){
print(name)
file <- paste0("kall_out/",name,"/abundance.tsv")
#print(file)
df_tmp <- sample_exp(file, name)
colnames(df_tmp)[2] <- name;
if( dim(exp_table)[1]==0){ exp_table = df_tmp}
else { exp_table <- full_join(exp_table,df_tmp,by = "target_id")}
#print(colnames(exp_table))
nissle_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_N")))
mutans_table <- cbind(exp_table$target_id, exp_table %>% select(matches("_M")))
}
for (i in 1:nrow(sort_cheat)){
#print(sort_cheat[i,"groups"])
name <- sort_cheat[i,"groups"]
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
paste0(groups, "_table") <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
}
View(nissle_table)
View(nissle_table)
View(nissle_table)
View(mutans_table)
View(mutans_table)
View(nissle_table)
View(nissle_table)
for (i in 1:nrow(sort_cheat)){
#print(sort_cheat[i,"groups"])
name <- sort_cheat[i,"groups"]
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
paste0(groups, "_table") <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
}
?paste0
paste0(sort_cheat[i,"groups"], "_table")
paste0(sort_cheat[1,"groups"], "_table")
}
#paste0(groups, "_table") <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
}
for (i in 1:nrow(sort_cheat)){
name <- paste0(sort_cheat[i,"groups"], "_table")
print(name)
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
#paste0(groups, "_table") <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
}
View(exp_table)
View(exp_table)
paste0(groups, "_table")
paste0(name, "_table")
paste0(name, "_table") <- 3
name <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern)))
)
exp_table$target_id, exp_table
exp_table$target_id
cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern))))
i = 0
name <- paste0(sort_cheat[i,"groups"], "_table")
print(name)
pattern <- sort_cheat[i,"pattern"]
name <- cbind(exp_table$target_id, exp_table %>% paste0(select(matches(pattern))))
name <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
name
exp_table %>% select(matches(pattern))
exp_table %>% select(matches("_M"))
pattern
i = 1
name <- paste0(sort_cheat[i,"groups"], "_table")
print(name)
pattern <- sort_cheat[i,"pattern"]
name <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
name
for (i in 1:nrow(sort_cheat)){
name <- paste0(sort_cheat[i,"groups"], "_table")
print(name)
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
name <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
}
cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
paste0("expout/", sort_cheat[i,"groups"], ".csv")
for (i in 1:nrow(sort_cheat)){
name <- paste0(sort_cheat[i,"groups"], "_table")
print(name)
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
table <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
write.csv(table, file=paste0("expout/", sort_cheat[i,"groups"], ".csv"), row.names = FALSE)
}
for (i in 1:nrow(sort_cheat)){
name <- paste0(sort_cheat[i,"groups"], "_table")
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
table <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
filename <- paste0("expout/", sort_cheat[i,"groups"], ".csv")
write.csv(table, file=filename, row.names = FALSE)
print(filename)
}
for (i in 1:nrow(sort_cheat)){
name <- paste0(sort_cheat[i,"groups"], "_table")
#print(sort_cheat[i,"pattern"])
pattern <- sort_cheat[i,"pattern"]
table <- cbind(exp_table$target_id, exp_table %>% select(matches(pattern)))
filename <- paste0("expout/", sort_cheat[i,"groups"], ".csv")
write.csv(table, file=filename, row.names = FALSE)
print(filename)
}
View(exp_table)
View(exp_table)
View(mutans_table)
View(mutans_table)
View(exp_table)
View(exp_table)
View(nissle_table)
View(nissle_table)
View(exp_table)
